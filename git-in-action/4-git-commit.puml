@startuml china online basic resource

title Git Commit

package "1 working directory" as workingdirectory {
  entity "test1.txt" as test1 {
  }

  entity "test2.txt" as test2 {
  }

  entity "test3.txt" as test3 {
  }
}

package "2 repository" {

  package ".git/refs" {
    entity "master" as master {
      *content: commit2 hash
    }

  }

  package ".git/objects" {
    package "blob files" as blob {

      entity "test1-blob1-hash" as test1blob1 {
        *header: blob+size
        *content: test content 1
      }

      entity "test1-blob2-hash" as test1blob2 {
        *header: blob+size
        *content: test content 1 modified
      }

      entity "test2-blob1-hash" as test2blob1 {
        *header: blob+size
        *content: test content 2
      }
      entity "test3-blob1-hash" as test3blob1 {
        *header: blob+size
        *content: test content 3
      }
    }

    package "tree files" {
      entity "tree1" as tree1 {
        *record1: test1-blob1-hash
        *record2: test2-blob1-hash
      }
      entity "tree2" as tree2 {
        *record1: test1-blob2-hash
        *record2: test2-blob1-hash
      }
      entity "tree3" as tree3 {
        *record1: test1-blob2-hash
        *record2: test2-blob1-hash
        *record3: test3-blob1-hash
      }
    }

    package "commit files" {
      entity "commit1" as commit1 {
        *tree: tree1
        *parent: null
        *auther: xxxx
        *dexc: xxxx
      }
      entity "commit2" as commit2 {
        *tree: tree2
        *parent: commit1
        *auther: xxxx
        *dexc: xxxx
      }
      entity "commit3" as commit3 {
        *tree: tree3
        *parent: commit2
        *auther: xxxx
        *dexc: xxxx
      }
    }
  }

  entity ".git/HEAD" as head {
    *content: .git/refs/master
  }
}

package "3 staging area" as staging {
  entity ".git/index" as index {
    content: current blob files in \n staging area & file status
  }

}

test1blob1 -- test1
test1blob2 -- test1
test2blob1 -- test2

tree1 --> test1blob1
tree1 --> test2blob1

tree2 --> test1blob2
tree2 --> test2blob1

commit1 --> tree1
commit2 --> tree2

commit1 <-- commit2
commit1 -[hidden]right-> commit2

master --> commit3
master -[hidden]left-> commit3

head --up> master

index --[hidden]up workingdirectory
test3blob1 <-- staging
test2blob1 <-- staging
test1blob2 <-- staging

tree3 --> test1blob2
tree3 --> test2blob1
tree3 --> test3blob1

commit2 <--right commit3
commit3 -- tree3

@enduml